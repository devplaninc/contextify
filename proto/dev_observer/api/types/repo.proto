syntax = "proto3";

package dev_observer.api.types.repo;

import "google/protobuf/timestamp.proto";

enum GitProvider {
  GITHUB = 0;
  BIT_BUCKET = 1;
}

message GitRepository {
  string id = 1;
  string name = 2;
  string full_name = 3;
  string url = 4;
  string description = 5;
  GitProvider provider = 6;
  optional GitProperties properties = 7;
}

message GitProperties {
  optional GitAppInfo app_info = 1;
  optional GitMeta meta = 2;
}

message GitMeta {
  google.protobuf.Timestamp last_refresh = 1;
  optional string clone_url = 2;
  optional int32 size_kb = 3;
}

message GitAppInfo {
  google.protobuf.Timestamp last_refresh = 1;
  optional int32 installation_id = 2;
}

message RepoToken {
  string id = 1;
  string namespace = 2;
  GitProvider provider = 3;
  // Name of the workspace if this is a workspace token.
  optional string workspace = 4;
  // Full name of the repo if this is a repo token.
  optional string repo = 5;
  // True if this is a system auto-provisioned token (e.g. provided by Forge for BitBucket)
  bool system = 6;
  string token = 7;
  optional google.protobuf.Timestamp expires_at = 8;
  google.protobuf.Timestamp created_at = 9;
  google.protobuf.Timestamp updated_at = 10;
}
